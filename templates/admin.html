{% extends "base.html" %}
{% block content %}
<div class="section-box admin-section">
    <h2>Administratorbereich</h2>
    <div class="admin-grid">
        <!-- Courses -->
        <div class="admin-box">
            <h3>Kurse verwalten</h3>
            <button class="admin-add-btn" onclick="openModal('courseModal')">＋ Kurs hinzufügen</button>
            <ul class="admin-list">
                {% for course in courses %}
                <li>
                    <strong>{{ course.name }}</strong> ({{ course.date }} {{ course.time }})
                    <button class="admin-remove-btn" onclick="deleteCourse({{ course.id }})">−</button>
                </li>
                {% endfor %}
            </ul>
        </div>
        <!-- Gallery -->
        <div class="admin-box">
            <h3>Galerie verwalten</h3>
            <form method="post" enctype="multipart/form-data" action="{{ url_for('admin_gallery_upload') }}">
                <button class="admin-add-btn" type="button" onclick="document.getElementById('gallery-upload').click()">＋ Bild hinzufügen</button>
                <input id="gallery-upload" name="photo" type="file" accept="image/*" style="display:none" onchange="this.form.submit()">
            </form>
            <div class="admin-gallery">
                {% for image in images %}
                <div class="admin-gallery-item">
                    <img src="{{ url_for('static', filename=image) }}" alt="Galeriebild">
                    <button class="admin-remove-btn" onclick="removeImage('{{ image }}')">−</button>
                </div>
                {% endfor %}
            </div>
        </div>
        <!-- Team -->
        <div class="admin-box">
            <h3>Team verwalten</h3>
            <button class="admin-add-btn" onclick="openModal('teamModal')">＋ Mitglied hinzufügen</button>
            <ul class="admin-list">
                {% for member in team %}
                <li>
                    <img src="{{ url_for('static', filename=member.photo) }}" alt="{{ member.name }}" class="admin-avatar">
                    <strong>{{ member.name }}</strong> – {{ member.role }}
                    <button class="admin-remove-btn" onclick="removeMember({{ member.id }})">−</button>
                </li>
                {% endfor %}
            </ul>
        </div>
        <!-- Blogs -->
        <div class="admin-box">
            <h3>Blogs verwalten</h3>
            <button class="admin-add-btn" onclick="openModal('blogModal')">＋ Blog hinzufügen</button>
            <ul class="admin-list">
                {% for blog in blogs %}
                <li>
                    <strong>{{ blog.title }}</strong>
                    <button class="admin-remove-btn" onclick="removeBlog({{ blog.id }})">−</button>
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>

<!-- Modals -->
<div id="courseModal" class="admin-modal">
    <form method="post" action="{{ url_for('admin_add_course') }}" class="admin-modal-content">
        <span class="admin-close" onclick="closeModal('courseModal')">&times;</span>
        <h3>Kurs hinzufügen</h3>
        <input name="name" required placeholder="Kursname">
        <textarea name="description" required placeholder="Beschreibung"></textarea>
        <input name="max_people" type="number" min="1" required placeholder="Max. Teilnehmer">
        <input name="date" type="date" required>
        <input name="time" type="time" required>
        <input name="price" type="number" min="0" step="0.01" required placeholder="Preis (CHF)">
        <button type="submit">Speichern</button>
    </form>
</div>
<div id="teamModal" class="admin-modal">
    <form method="post" action="{{ url_for('admin_add_member') }}" enctype="multipart/form-data" class="admin-modal-content">
        <span class="admin-close" onclick="closeModal('teamModal')">&times;</span>
        <h3>Mitglied hinzufügen</h3>
        <input name="name" required placeholder="Name">
        <input name="role" required placeholder="Rolle">
        <input name="photo" type="file" required accept="image/*">
        <button type="submit">Speichern</button>
    </form>
</div>
<div id="blogModal" class="admin-modal">
    <form method="post" action="{{ url_for('admin_add_blog') }}" class="admin-modal-content">
        <span class="admin-close" onclick="closeModal('blogModal')">&times;</span>
        <h3>Blog hinzufügen</h3>
        <input name="title" required placeholder="Titel">
        <textarea name="text" required placeholder="Text"></textarea>
        <button type="submit">Speichern</button>
    </form>
</div>
<script>
function openModal(id) { document.getElementById(id).style.display = 'block'; }
function closeModal(id) { document.getElementById(id).style.display = 'none'; }
function deleteCourse(id) { /* AJAX or form submit to delete course */ }
function removeImage(filename) { /* AJAX or form submit to remove image */ }
function removeMember(id) { /* AJAX or form submit to remove member */ }
function removeBlog(id) { /* AJAX or form submit to remove blog */ }
</script>
{% endblock %}
